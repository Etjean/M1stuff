source("TP_ADB1.R")
source("TP_ADB1.R")
dist(pockets)
dist(pockets[,-37])
pockets = read.table("descriptor_pocket.mat")
source('~/Github/TP_ADB1.R')
plot(cars)
plot(cars)
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
plot(pressure)
knitr::opts_chunk$set(echo = TRUE)
summary(cars)
source('~/Github/TP_ADB1.R')
knitr::opts_chunk$set(echo = TRUE)
pockets.tree = hclust(pockets.dist, method = "ward.D2")
plot(cars)
pockets = read.table("descriptor_pocket.mat")
names(pockets)
dim(pockets)
#is.na(pockets)
pockets = na.omit(pockets)
dim(pockets)
aromatic = apply(cbind(pockets$F, pockets$Y, pockets$H, pockets$W), 1, sum)
polar = apply(cbind(pockets$C, pockets$D, pockets$E, pockets$H, pockets$K, pockets$N, pockets$Q, pockets$R, pockets$S, pockets$T, pockets$W, pockets$Y), 1, sum)
aliphatic = apply(cbind(pockets$I, pockets$L, pockets$V), 1, sum)
charged = apply(cbind(pockets$D, pockets$E, pockets$R, pockets$K, pockets$H), 1, sum)
negative = apply(cbind(pockets$D, pockets$E), 1, sum)
positive = apply(cbind(pockets$R, pockets$K, pockets$H), 1, sum)
hydrophobic = apply(cbind(pockets$C, pockets$G, pockets$A, pockets$T, pockets$V, pockets$L, pockets$I, pockets$M, pockets$F, pockets$W, pockets$H, pockets$Y, pockets$K), 1, sum)
small = apply(cbind(pockets$C, pockets$G, pockets$A, pockets$T, pockets$V, pockets$S, pockets$D, pockets$N, pockets$P), 1, sum)
tiny = apply(cbind(pockets$A, pockets$C, pockets$G, pockets$S), 1, sum)
pockets = cbind(pockets, aromatic, polar, aliphatic, charged, negative, positive, hydrophobic, small, tiny)
#mise de "drugg" à la fin du tableau
noms = names(pockets)
pockets = cbind(pockets[,1:27], pockets[,29:37], pockets[,28])
colnames(pockets)[37] = noms[28]
names(pockets)   #37 descriptors
boxplot(scale(pockets[,-37]), las=2)
#ma version
hist(pockets$polar[pockets$drugg == 1], freq=F, col = "purple", xlim = c(0, 1))
hist(pockets$polar[pockets$drugg == 0], freq=F, col =rgb(1,0,0,0.5), add=T)
#version prof
# par(mfrow = c(1, 2))
# for (i in c(1:36))
#     by(pockets[,i], pockets$drugg, hist, main = "un histogramme")
#ma version
# for (i in 1:36){
#     print(mean(pockets[,i][pockets$drugg == 1]))
#     print(mean(pockets[,i][pockets$drugg == 0]))
#     print(sd(pockets[,i][pockets$drugg == 1]))
#     print(sd(pockets[,i][pockets$drugg == 0]))
# }
#version prof
# lapply(pockets, mean)
# lapply(pockets, sd)
print(means <- aggregate(pockets[,-37], by=list(pockets$drugg), FUN = mean))
print(sds <- aggregate(pockets[,-37], by=list(pockets$drugg), FUN = sd))
pockets.pvalues = c()
for (i in 1:36){
# Optionnel, il faudrait comparer les variances, comme condition d'application du Student
#    var.test(pockets[,i][pockets$drugg == 1], pockets[,i][pockets$drugg == 0])
pvalue = t.test(pockets[,i][pockets$drugg == 1], pockets[,i][pockets$drugg == 0])$p.value
pockets.pvalues = c(pockets.pvalues, pvalue)
}
pockets.pvalues
drug.corr = cor(pockets[,-37])
library(corrplot)
corrplot(drug.corr)
plot(pockets$polar, pockets$hydrophobic)
plot(pockets$Real_volume, pockets$C_ATOM)
pockets.dist = dist(scale(pockets[,-37]))
# donne un matrice triangulaire inférieure de la distance de tous les résidus 2 à 2
pockets.tree = hclust(pockets.dist, method = "ward.D2")
plot(pockets.tree, hang=-1, labels = pockets$drugg)
rect.hclust(pockets.tree, k = 4, border = "red")
rect.hclust(pockets.tree, k = 6, border = "red")
rect.hclust(pockets.tree, k = 8, border = "red")
plot(cars)
pockets = read.table("descriptor_pocket.mat")
names(pockets)
dim(pockets)
#is.na(pockets)
pockets = na.omit(pockets)
dim(pockets)
aromatic = apply(cbind(pockets$F, pockets$Y, pockets$H, pockets$W), 1, sum)
polar = apply(cbind(pockets$C, pockets$D, pockets$E, pockets$H, pockets$K, pockets$N, pockets$Q, pockets$R, pockets$S, pockets$T, pockets$W, pockets$Y), 1, sum)
aliphatic = apply(cbind(pockets$I, pockets$L, pockets$V), 1, sum)
charged = apply(cbind(pockets$D, pockets$E, pockets$R, pockets$K, pockets$H), 1, sum)
negative = apply(cbind(pockets$D, pockets$E), 1, sum)
positive = apply(cbind(pockets$R, pockets$K, pockets$H), 1, sum)
hydrophobic = apply(cbind(pockets$C, pockets$G, pockets$A, pockets$T, pockets$V, pockets$L, pockets$I, pockets$M, pockets$F, pockets$W, pockets$H, pockets$Y, pockets$K), 1, sum)
small = apply(cbind(pockets$C, pockets$G, pockets$A, pockets$T, pockets$V, pockets$S, pockets$D, pockets$N, pockets$P), 1, sum)
tiny = apply(cbind(pockets$A, pockets$C, pockets$G, pockets$S), 1, sum)
pockets = cbind(pockets, aromatic, polar, aliphatic, charged, negative, positive, hydrophobic, small, tiny)
#mise de "drugg" à la fin du tableau
noms = names(pockets)
pockets = cbind(pockets[,1:27], pockets[,29:37], pockets[,28])
colnames(pockets)[37] = noms[28]
names(pockets)   #37 descriptors
boxplot(scale(pockets[,-37]), las=2)
#ma version
hist(pockets$polar[pockets$drugg == 1], freq=F, col = "purple", xlim = c(0, 1))
hist(pockets$polar[pockets$drugg == 0], freq=F, col =rgb(1,0,0,0.5), add=T)
#version prof
# par(mfrow = c(1, 2))
# for (i in c(1:36))
#     by(pockets[,i], pockets$drugg, hist, main = "un histogramme")
#ma version
# for (i in 1:36){
#     print(mean(pockets[,i][pockets$drugg == 1]))
#     print(mean(pockets[,i][pockets$drugg == 0]))
#     print(sd(pockets[,i][pockets$drugg == 1]))
#     print(sd(pockets[,i][pockets$drugg == 0]))
# }
#version prof
# lapply(pockets, mean)
# lapply(pockets, sd)
print(means <- aggregate(pockets[,-37], by=list(pockets$drugg), FUN = mean))
print(sds <- aggregate(pockets[,-37], by=list(pockets$drugg), FUN = sd))
pockets.pvalues = c()
for (i in 1:36){
# Optionnel, il faudrait comparer les variances, comme condition d'application du Student
#    var.test(pockets[,i][pockets$drugg == 1], pockets[,i][pockets$drugg == 0])
pvalue = t.test(pockets[,i][pockets$drugg == 1], pockets[,i][pockets$drugg == 0])$p.value
pockets.pvalues = c(pockets.pvalues, pvalue)
}
pockets.pvalues
# drug.corr = cor(pockets[,-37])
# library(corrplot)
# corrplot(drug.corr)
# plot(pockets$polar, pockets$hydrophobic)
# plot(pockets$Real_volume, pockets$C_ATOM)
pockets.dist = dist(scale(pockets[,-37]))
# donne un matrice triangulaire inférieure de la distance de tous les résidus 2 à 2
pockets.tree = hclust(pockets.dist, method = "ward.D2")
plot(pockets.tree, hang=-1, labels = pockets$drugg, xlab = "Poches (1 = druggable, 0 = non-druggable)", ylab = "Distance", main = "Dendrogramme par la m?thode de Ward")
rect.hclust(pockets.tree, k = 5, border = "red")
# rect.hclust(pockets.tree, k = 6, border = "red")
# rect.hclust(pockets.tree, k = 8, border = "red")
pockets.kmeans = kmeans(pockets[, -37], centers = 3)
pockets.kmeans$cluster
plot(hclust(pockets.dist), hang = -1, labels = as.factor(pockets.kmeans$cluster))
I.intra = rep(0, 10)
I.intra
for (i in 1:length(I.intra)){
I.intra[i] = kmeans(pockets, centers = i)$tot.withinss
}
plot(I.intra, type = "l", xlab = "Nombre de clusters", ylab = "Inertie intra-classe", main = "D?termination du nombre de cluster id?al par la m?thode des kmeans")
abline(v=3, col = "red")
text(3, 40000000, "3 clusters", col = "red")
library(FactoMineR)
library(FactoMineR)
pockets.acp = PCA(pockets)
library(FactoMineR)
pockets.acp = PCA(pockets, ncp = 5, )
barplot(pockets.acp$eig[,1], main="valeur propre", names.arg=1:nrow(pockets.acp$eig))
library(FactoMineR)
pockets.acp = PCA(pockets, ncp = 5, scale.unit = T)
barplot(pockets.acp$eig[,1], main="valeur propre", names.arg=1:nrow(pockets.acp$eig))
pockets.acp = PCA(pockets, ncp = 3, scale.unit = T)
pockets.acp = PCA(pockets, ncp = 3, scale.unit = F)
pockets.acp = PCA(pockets, ncp = 3, axes=c(2, 3))
pockets.acp = PCA(pockets, ncp = 8, axes=c(2, 3))
library(FactoMineR)
par(nfrow=c(1, 2))
pockets.acp = PCA(pockets, ncp = 3, axes=c(2, 3))
pockets.acp = PCA(pockets, ncp = 8, axes=c(2, 3))
# SMALL et TINY en haut
# AROMATIC en bas
# POLAR et CHARGED a gauche
# HYDROPHOBIC et ALIPHATIC a droite
barplot(pockets.acp$eig[,1], main="valeur propre", names.arg=1:nrow(pockets.acp$eig))
library(FactoMineR)
par(nfrow=c(1, 2))
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2))
pockets.acp = PCA(pockets, ncp = 5, axes=c(2, 3))
# SMALL et TINY en haut
# AROMATIC en bas
# POLAR et CHARGED a gauche
# HYDROPHOBIC et ALIPHATIC a droite
barplot(pockets.acp$eig[,1], main="valeur propre", names.arg=1:nrow(pockets.acp$eig))
library(FactoMineR)
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2))
pockets.acp = PCA(pockets, ncp = 5, axes=c(2, 3))
# SMALL et TINY en haut
# AROMATIC en bas
# POLAR et CHARGED a gauche
# HYDROPHOBIC et ALIPHATIC a droite
barplot(pockets.acp$eig[,1], main="valeur propre", names.arg=1:nrow(pockets.acp$eig))
library(FactoMineR)
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2))
pockets.acp = PCA(pockets, ncp = 5, axes=c(3, 4))
# SMALL et TINY en haut
# AROMATIC en bas
# POLAR et CHARGED a gauche
# HYDROPHOBIC et ALIPHATIC a droite
barplot(pockets.acp$eig[,1], main="valeur propre", names.arg=1:nrow(pockets.acp$eig))
pockets.acp$eig
barplot(pockets.acp$eig[,1], main="valeur propre", names.arg=1:nrow(pockets.acp$eig))
library(FactoMineR)
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2))
pockets.acp = PCA(pockets, ncp = 5, axes=c(3, 4))
# SMALL et TINY en haut
# AROMATIC en bas
# POLAR et CHARGED a gauche
# HYDROPHOBIC et ALIPHATIC a droite
barplot(pockets.acp$eig[,1], main="valeur propre", names.arg=1:nrow(pockets.acp$eig))
pockets.acp$eig[,1]
pockets.acp$eig
barplot(pockets.acp$eig[,3])
library(FactoMineR)
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2))
pockets.acp = PCA(pockets, ncp = 5, axes=c(3, 4))
# SMALL et TINY en haut
# AROMATIC en bas
# POLAR et CHARGED a gauche
# HYDROPHOBIC et ALIPHATIC a droite
barplot(pockets.acp$eig[,1], main="valeur propre", names.arg=1:nrow(pockets.acp$eig))
barplot(pockets.acp$eig[,3], main="Somme cumulé des variances")
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2), col.w = pockets[,37])
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2), quanti.sup = pockets[,37])
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2), quali.sup = pockets[,37])
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2), quali.sup = 37)
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2), quanti.sup = 37)
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2), quali.sup = 37)
library(FactoMineR)
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2), quali.sup = 37)
pockets.acp = PCA(pockets, ncp = 5, axes=c(3, 4))
# dimension 1 : SMALL + TINY // AROMATIC
# dimension 2 : POLAR + CHARGED // HYDROPHOBIC + ALIPHATIC
# dimension 3 : C_RESIDUES + C_ATOM + REAL_VOLUME // MEAN_ALPHA.SPHERE_SA + MEAN_ALPHA.SPHERE_RADIUS
barplot(pockets.acp$eig[,1], main="valeurs propres", names.arg=1:nrow(pockets.acp$eig))
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2), quali.sup = pockets[,37])
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2), quali.sup =)
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2))
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2))
plot(pockets.acp, col.hab = pockets[,37])
library(FactoMineR)
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2), quali.sup = 5)
plot(pockets.acp, habillage = 5, col.hab = "green")
library(FactoMineR)
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2), quali.sup = 2)
plot(pockets.acp, habillage = 2, col.hab = "green", invisible = 'quali')
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2), quali.sup = 37, invisible='quali')
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2), quali.sup = 37)
plot.PCA(pockets.acp, habillage = 37,  invisible="quali")
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2), quali.sup = 37)
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2), quali.sup = 37)
plot.PCA(pockets.acp, habillage = 37,  invisible="quali")
library(FactoMineR)
pockets.acp = PCA(pockets, ncp = 5, axes=c(1, 2), quali.sup = 37)
plot.PCA(pockets.acp, habillage = 37,  invisible="quali")
plot.PCA(pockets.acp, habillage = 37,  invisible="quali", legend = c("druggable", "non-druggable"))
plot.PCA(pockets.acp, habillage = 37,  invisible="quali", legend = TRUE)
plot(pockets.acp, habillage = 37,  invisible="quali", legend = TRUE)
plot(pockets.acp, habillage = 37,  invisible="quali", col.hab = c("green", "blue"))
plot(pockets.acp, habillage = 37,  invisible="quali", col.hab = c("green", "blue"), legend=c(1,2))
plot(pockets.acp, habillage = 37,  invisible="quali", col.hab = c("green", "blue"), legend=1
pockets.acp = PCA(pockets, ncp = 5, axes=c(3, 4))
plot(pockets.acp, habillage = 37,  invisible="quali", col.hab = c("green", "blue"), legend=1)
library(FactoMineR)
pockets.acp12 = PCA(pockets, ncp = 5, axes=c(1, 2), quali.sup = 37)
plot(pockets.acp12, habillage = 37,  invisible="quali", col.hab = c("green", "blue"), legend=1)
plot(pockets.acp12, habillage = 37,  invisible="quali", col.hab = c("green", "blue"))
plot.PCA(pockets.acp12, habillage = 37,  invisible="quali", col.hab = c("green", "blue"))
pockets.acp34 = PCA(pockets, ncp = 5, axes=c(3, 4))
pockets.kmeans$cluster
pockets.acpclusters = PCA(pockets, ncp = 5, axes=c(1, 2), quali.sup = 37)
plot(pockets.acpclusters, habillage = pockets.kmeans)
plot(pockets.acpclusters, habillage = pockets.kmeans$clusters)
plot(pockets.acpclusters, col.hab = pockets.kmeans$clusters)
plot(pockets.acpclusters, col.hab = pockets.kmeans$clusters)
pockets.acpclusters = PCA(pockets, ncp = 5, axes=c(1, 2))
plot(pockets.acpclusters, col.hab = pockets.kmeans$clusters)
plot(pockets.acpclusters, col.ind = pockets.kmeans$clusters)
plot(pockets.acpclusters, choix = "ind", col.ind = pockets.kmeans$clusters )
plot(pockets.acpclusters, choix = "ind", col.ind = pockets.kmeans$clusters )
plot(pockets.acpclusters, choix = "ind", col.ind = pockets.kmeans$clusters)
plot(pockets.acpclusters, choix = "ind", col.ind = pockets.kmeans$clusters)
pockets.kmeans$clusters
plot(cars)
pockets = read.table("descriptor_pocket.mat")
names(pockets)
dim(pockets)
#is.na(pockets)
pockets = na.omit(pockets)
dim(pockets)
aromatic = apply(cbind(pockets$F, pockets$Y, pockets$H, pockets$W), 1, sum)
polar = apply(cbind(pockets$C, pockets$D, pockets$E, pockets$H, pockets$K, pockets$N, pockets$Q, pockets$R, pockets$S, pockets$T, pockets$W, pockets$Y), 1, sum)
aliphatic = apply(cbind(pockets$I, pockets$L, pockets$V), 1, sum)
charged = apply(cbind(pockets$D, pockets$E, pockets$R, pockets$K, pockets$H), 1, sum)
negative = apply(cbind(pockets$D, pockets$E), 1, sum)
positive = apply(cbind(pockets$R, pockets$K, pockets$H), 1, sum)
hydrophobic = apply(cbind(pockets$C, pockets$G, pockets$A, pockets$T, pockets$V, pockets$L, pockets$I, pockets$M, pockets$F, pockets$W, pockets$H, pockets$Y, pockets$K), 1, sum)
small = apply(cbind(pockets$C, pockets$G, pockets$A, pockets$T, pockets$V, pockets$S, pockets$D, pockets$N, pockets$P), 1, sum)
tiny = apply(cbind(pockets$A, pockets$C, pockets$G, pockets$S), 1, sum)
pockets = cbind(pockets, aromatic, polar, aliphatic, charged, negative, positive, hydrophobic, small, tiny)
#mise de "drugg" à la fin du tableau
noms = names(pockets)
pockets = cbind(pockets[,1:27], pockets[,29:37], pockets[,28])
colnames(pockets)[37] = noms[28]
names(pockets)   #37 descriptors
boxplot(scale(pockets[,-37]), las=2)
#ma version
hist(pockets$polar[pockets$drugg == 1], freq=F, col = "purple", xlim = c(0, 1))
hist(pockets$polar[pockets$drugg == 0], freq=F, col =rgb(1,0,0,0.5), add=T)
#version prof
# par(mfrow = c(1, 2))
# for (i in c(1:36))
#     by(pockets[,i], pockets$drugg, hist, main = "un histogramme")
#ma version
# for (i in 1:36){
#     print(mean(pockets[,i][pockets$drugg == 1]))
#     print(mean(pockets[,i][pockets$drugg == 0]))
#     print(sd(pockets[,i][pockets$drugg == 1]))
#     print(sd(pockets[,i][pockets$drugg == 0]))
# }
#version prof
# lapply(pockets, mean)
# lapply(pockets, sd)
print(means <- aggregate(pockets[,-37], by=list(pockets$drugg), FUN = mean))
print(sds <- aggregate(pockets[,-37], by=list(pockets$drugg), FUN = sd))
pockets.pvalues = c()
for (i in 1:36){
# Optionnel, il faudrait comparer les variances, comme condition d'application du Student
#    var.test(pockets[,i][pockets$drugg == 1], pockets[,i][pockets$drugg == 0])
pvalue = t.test(pockets[,i][pockets$drugg == 1], pockets[,i][pockets$drugg == 0])$p.value
pockets.pvalues = c(pockets.pvalues, pvalue)
}
pockets.pvalues
# drug.corr = cor(pockets[,-37])
# library(corrplot)
# corrplot(drug.corr)
# plot(pockets$polar, pockets$hydrophobic)
# plot(pockets$Real_volume, pockets$C_ATOM)
pockets.dist = dist(scale(pockets[,-37]))
# donne un matrice triangulaire inférieure de la distance de tous les résidus 2 à 2
pockets.tree = hclust(pockets.dist, method = "ward.D2")
plot(pockets.tree, hang=-1, labels = pockets$drugg, xlab = "Poches (1 = druggable, 0 = non-druggable)", ylab = "Distance", main = "Dendrogramme par la m?thode de Ward")
rect.hclust(pockets.tree, k = 5, border = "red")
# rect.hclust(pockets.tree, k = 6, border = "red")
# rect.hclust(pockets.tree, k = 8, border = "red")
pockets.kmeans = kmeans(pockets[, -37], centers = 3)
pockets.kmeans$cluster
plot(hclust(pockets.dist), hang = -1, labels = as.factor(pockets.kmeans$cluster))
I.intra = rep(0, 10)
I.intra
for (i in 1:length(I.intra)){
I.intra[i] = kmeans(pockets, centers = i)$tot.withinss
}
plot(I.intra, type = "l", xlab = "Nombre de clusters", ylab = "Inertie intra-classe", main = "D?termination du nombre de cluster id?al par la m?thode des kmeans")
abline(v=3, col = "red")
text(3, 40000000, "3 clusters", col = "red")
library(FactoMineR)
pockets.acp12 = PCA(pockets, ncp = 5, axes=c(1, 2))
# plot.PCA(pockets.acp12, habillage = 37,  invisible="quali", col.hab = c("green", "blue"))
pockets.acp34 = PCA(pockets, ncp = 5, axes=c(3, 4))
# dimension 1 : SMALL + TINY // AROMATIC
# dimension 2 : POLAR + CHARGED // HYDROPHOBIC + ALIPHATIC
# dimension 3 : C_RESIDUES + C_ATOM + REAL_VOLUME // MEAN_ALPHA.SPHERE_SA + MEAN_ALPHA.SPHERE_RADIUS
barplot(pockets.acp$eig[,1], main="valeurs propres", names.arg=1:nrow(pockets.acp$eig))
barplot(pockets.acp$eig[,3], main="Somme cumulé des variances")
pockets.acpclusters = PCA(pockets, ncp = 5, axes=c(1, 2))
plot(pockets.acpclusters, choix = "ind", col.ind = pockets.kmeans$clusters)
pockets.kmeans$clusters
pockets.kmeans = kmeans(pockets[, -37], centers = 3)
pockets.kmeans$cluster
plot(hclust(pockets.dist), hang = -1, labels = as.factor(pockets.kmeans$cluster))
I.intra = rep(0, 10)
I.intra
for (i in 1:length(I.intra)){
I.intra[i] = kmeans(pockets, centers = i)$tot.withinss
}
pockets.kmeans$cluster
plot(pockets.acpclusters, choix = "ind", col.ind = pockets.kmeans$cluster)
plot(pockets.acp12, choix = "ind", col.ind = pockets[,37])
plot(pockets.acp12, choix = "ind", col.ind = (pockets[,37]+1))
library(FactoMineR)
pockets.acp12 = PCA(pockets, ncp = 5, axes=c(1, 2))
plot(pockets.acp12, choix = "ind", col.ind = (pockets[,37]+1))
pockets.acp34 = PCA(pockets, ncp = 5, axes=c(3, 4))
# dimension 1 : SMALL + TINY // AROMATIC
# dimension 2 : POLAR + CHARGED // HYDROPHOBIC + ALIPHATIC
# dimension 3 : C_RESIDUES + C_ATOM + REAL_VOLUME // MEAN_ALPHA.SPHERE_SA + MEAN_ALPHA.SPHERE_RADIUS
barplot(pockets.acp$eig[,1], main="valeurs propres", names.arg=1:nrow(pockets.acp$eig))
plot(pockets.acp12, choix = "ind", col.ind = (pockets[,37]+1), main = "NOIRS = non-druggables // ROUGES = druggables")
plot(pockets.acp12, choix = "ind", col.ind = (pockets[,37]+1), main = "NOIRS = non-druggables")
plot(pockets.acp12, choix = "ind", col.ind = (pockets[,37]+1), title = "NOIRS = non-druggables // ROUGES = druggables")
library(FactoMineR)
pockets.acp12 = PCA(pockets, ncp = 5, axes=c(1, 2))
plot(pockets.acp12, choix = "ind", col.ind = (pockets[,37]+1), title = "NOIRS = non-druggables // ROUGES = druggables")
pockets.acp34 = PCA(pockets, ncp = 5, axes=c(3, 4))
# dimension 1 : SMALL + TINY // AROMATIC
# dimension 2 : POLAR + CHARGED // HYDROPHOBIC + ALIPHATIC
# dimension 3 : C_RESIDUES + C_ATOM + REAL_VOLUME // MEAN_ALPHA.SPHERE_SA + MEAN_ALPHA.SPHERE_RADIUS
barplot(pockets.acp$eig[,1], main="valeurs propres", names.arg=1:nrow(pockets.acp$eig))
library(FactoMineR)
pockets.acp12 = PCA(pockets, ncp = 5, axes=c(1, 2))
plot(pockets.acp12, choix = "ind", col.ind = (pockets[,37]+1), title = "NOIRS = non-druggables // ROUGES = druggables")
pockets.acp34 = PCA(pockets, ncp = 5, axes=c(3, 4))
# dimension 1 : SMALL + TINY // AROMATIC
# dimension 2 : POLAR + CHARGED // HYDROPHOBIC + ALIPHATIC
# dimension 3 : C_RESIDUES + C_ATOM + REAL_VOLUME // MEAN_ALPHA.SPHERE_SA + MEAN_ALPHA.SPHERE_RADIUS
barplot(pockets.acp$eig[,1], main="valeurs propres", names.arg=1:nrow(pockets.acp$eig))
barplot(pockets.acp$eig[,3], main="Somme cumulé des variances")
pockets.kmeans = kmeans(pockets[, -37], centers = 6)
plot(pockets.acpclusters, choix = "ind", col.ind = pockets.kmeans$cluster)
pockets.kmeans = kmeans(pockets[, -37], centers = 5)
plot(pockets.acpclusters, choix = "ind", col.ind = pockets.kmeans$cluster)
pockets.kmeans = kmeans(pockets[, -37], centers = 4)
plot(pockets.acpclusters, choix = "ind", col.ind = pockets.kmeans$cluster)
pockets.kmeans = kmeans(pockets[, -37], centers = 3)
plot(pockets.acpclusters, choix = "ind", col.ind = pockets.kmeans$cluster)
pockets.kmeans = kmeans(pockets[, -37], centers = 4)
plot(pockets.acpclusters, choix = "ind", col.ind = pockets.kmeans$cluster)
plot(cars)
pockets = read.table("descriptor_pocket.mat")
names(pockets)
dim(pockets)
#is.na(pockets)
pockets = na.omit(pockets)
dim(pockets)
aromatic = apply(cbind(pockets$F, pockets$Y, pockets$H, pockets$W), 1, sum)
polar = apply(cbind(pockets$C, pockets$D, pockets$E, pockets$H, pockets$K, pockets$N, pockets$Q, pockets$R, pockets$S, pockets$T, pockets$W, pockets$Y), 1, sum)
aliphatic = apply(cbind(pockets$I, pockets$L, pockets$V), 1, sum)
charged = apply(cbind(pockets$D, pockets$E, pockets$R, pockets$K, pockets$H), 1, sum)
negative = apply(cbind(pockets$D, pockets$E), 1, sum)
positive = apply(cbind(pockets$R, pockets$K, pockets$H), 1, sum)
hydrophobic = apply(cbind(pockets$C, pockets$G, pockets$A, pockets$T, pockets$V, pockets$L, pockets$I, pockets$M, pockets$F, pockets$W, pockets$H, pockets$Y, pockets$K), 1, sum)
small = apply(cbind(pockets$C, pockets$G, pockets$A, pockets$T, pockets$V, pockets$S, pockets$D, pockets$N, pockets$P), 1, sum)
tiny = apply(cbind(pockets$A, pockets$C, pockets$G, pockets$S), 1, sum)
pockets = cbind(pockets, aromatic, polar, aliphatic, charged, negative, positive, hydrophobic, small, tiny)
#mise de "drugg" à la fin du tableau
noms = names(pockets)
pockets = cbind(pockets[,1:27], pockets[,29:37], pockets[,28])
colnames(pockets)[37] = noms[28]
names(pockets)   #37 descriptors
boxplot(scale(pockets[,-37]), las=2)
#ma version
hist(pockets$polar[pockets$drugg == 1], freq=F, col = "purple", xlim = c(0, 1))
hist(pockets$polar[pockets$drugg == 0], freq=F, col =rgb(1,0,0,0.5), add=T)
#version prof
# par(mfrow = c(1, 2))
# for (i in c(1:36))
#     by(pockets[,i], pockets$drugg, hist, main = "un histogramme")
#ma version
# for (i in 1:36){
#     print(mean(pockets[,i][pockets$drugg == 1]))
#     print(mean(pockets[,i][pockets$drugg == 0]))
#     print(sd(pockets[,i][pockets$drugg == 1]))
#     print(sd(pockets[,i][pockets$drugg == 0]))
# }
#version prof
# lapply(pockets, mean)
# lapply(pockets, sd)
print(means <- aggregate(pockets[,-37], by=list(pockets$drugg), FUN = mean))
print(sds <- aggregate(pockets[,-37], by=list(pockets$drugg), FUN = sd))
pockets.pvalues = c()
for (i in 1:36){
# Optionnel, il faudrait comparer les variances, comme condition d'application du Student
#    var.test(pockets[,i][pockets$drugg == 1], pockets[,i][pockets$drugg == 0])
pvalue = t.test(pockets[,i][pockets$drugg == 1], pockets[,i][pockets$drugg == 0])$p.value
pockets.pvalues = c(pockets.pvalues, pvalue)
}
pockets.pvalues
# drug.corr = cor(pockets[,-37])
# library(corrplot)
# corrplot(drug.corr)
# plot(pockets$polar, pockets$hydrophobic)
# plot(pockets$Real_volume, pockets$C_ATOM)
pockets.dist = dist(scale(pockets[,-37]))
# donne un matrice triangulaire inférieure de la distance de tous les résidus 2 à 2
pockets.tree = hclust(pockets.dist, method = "ward.D2")
plot(pockets.tree, hang=-1, labels = pockets$drugg, xlab = "Poches (1 = druggable, 0 = non-druggable)", ylab = "Distance", main = "Dendrogramme par la m?thode de Ward")
rect.hclust(pockets.tree, k = 5, border = "red")
# rect.hclust(pockets.tree, k = 6, border = "red")
# rect.hclust(pockets.tree, k = 8, border = "red")
pockets.kmeans = kmeans(pockets[, -37], centers = 3)
pockets.kmeans$cluster
plot(hclust(pockets.dist), hang = -1, labels = as.factor(pockets.kmeans$cluster))
I.intra = rep(0, 10)
I.intra
for (i in 1:length(I.intra)){
I.intra[i] = kmeans(pockets, centers = i)$tot.withinss
}
plot(I.intra, type = "l", xlab = "Nombre de clusters", ylab = "Inertie intra-classe", main = "D?termination du nombre de cluster id?al par la m?thode des kmeans")
abline(v=3, col = "red")
text(3, 40000000, "3 clusters", col = "red")
library(FactoMineR)
pockets.acp12 = PCA(pockets, ncp = 5, axes=c(1, 2))
plot(pockets.acp12, choix = "ind", col.ind = (pockets[,37]+1), title = "NOIRS = non-druggables // ROUGES = druggables")
pockets.acp34 = PCA(pockets, ncp = 5, axes=c(3, 4))
# dimension 1 : SMALL + TINY // AROMATIC
# dimension 2 : POLAR + CHARGED // HYDROPHOBIC + ALIPHATIC
# dimension 3 : C_RESIDUES + C_ATOM + REAL_VOLUME // MEAN_ALPHA.SPHERE_SA + MEAN_ALPHA.SPHERE_RADIUS
barplot(pockets.acp$eig[,1], main="valeurs propres", names.arg=1:nrow(pockets.acp$eig))
barplot(pockets.acp$eig[,3], main="Somme cumulé des variances")
#Couleurs des individus en fonctions des clusters
pockets.kmeans = kmeans(pockets[, -37], centers = 4)
plot(pockets.acpclusters, choix = "ind", col.ind = pockets.kmeans$cluster)
#Couleurs des individus en fonctions des clusters
pockets.kmeans = kmeans(pockets[, -37], centers = 5)
plot(pockets.acpclusters, choix = "ind", col.ind = pockets.kmeans$cluster)
#Couleurs des individus en fonctions des clusters
pockets.kmeans = kmeans(sclae(pockets[, -37]), centers = 5)
#Couleurs des individus en fonctions des clusters
pockets.kmeans = kmeans(scale(pockets[, -37]), centers = 5)
plot(pockets.acpclusters, choix = "ind", col.ind = pockets.kmeans$cluster)
